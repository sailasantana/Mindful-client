{"ast":null,"code":"import _classCallCheck from\"/Users/rockerbox/capstones/c2-client/mindful/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/rockerbox/capstones/c2-client/mindful/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/rockerbox/capstones/c2-client/mindful/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/rockerbox/capstones/c2-client/mindful/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from'react';import{Link}from'react-router-dom';import journalContext from'../journal-context';import config from'../config';import TokenService from'../Auth-Service/token-services';import'./Edit.css';var Edit=/*#__PURE__*/function(_React$Component){_inherits(Edit,_React$Component);var _super=_createSuper(Edit);function Edit(props){var _this;_classCallCheck(this,Edit);_this=_super.call(this,props);_this.submitUpdate=function(e){e.preventDefault();var updatedEntry={content:_this.bodyInput.current.value};fetch(\"\".concat(config.API_ENDPOINT,\"/api/\").concat(_this.context.user_name,\"/\").concat(_this.props.match.params.id),{method:'PATCH',headers:{'content-type':'application/json','session_token':TokenService.getAuthToken()},body:JSON.stringify(updatedEntry)}).then(function(res){if(!res.ok){return res.json().then(function(e){return Promise.reject(e);});}return res;}).then(function(){_this.context.updatePost({id:_this.props.match.params.id,content:_this.bodyInput.current.value});_this.props.history.push('/dashboard');}).catch(function(error){alert({error:error});});};_this.bodyInput=/*#__PURE__*/React.createRef();_this.state={error:null};return _this;}_createClass(Edit,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var token=TokenService.getAuthToken();var options={method:'GET',headers:{'session_token':token}};fetch(\"\".concat(config.API_ENDPOINT,\"/api/validate\"),options).then(function(response){if(response.ok){return response.json();}throw new Error(response.statusText);}).then(function(responseJson){_this2.setState({message:responseJson.message});}).catch(function(err){console.log(err.message);_this2.props.history.push('/');});}},{key:\"render\",value:function render(){var _this3=this;var getContent=this.context.posts.filter(function(post){return post.id==_this3.props.match.params.id;});return/*#__PURE__*/_jsxs(\"div\",{className:\"Journal-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"Edit-label\",children:\"What Would you like to Change?\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"Journal-form\",onSubmit:this.submitUpdate,children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"textarea\",name:\"body\",id:\"body\",ref:this.bodyInput,defaultValue:getContent[0].content,className:\"Entry-content\",rows:\"23\",cols:\"70\"}),/*#__PURE__*/_jsx(\"button\",{className:\"Edit-button\",children:\"Edit\"})]})]});}}]);return Edit;}(React.Component);Edit.defaultProps={history:{goBack:function goBack(){}},match:{params:{}}};Edit.contextType=journalContext;export{Edit as default};","map":{"version":3,"sources":["/Users/rockerbox/capstones/c2-client/mindful/src/Edit-Form/Edit.js"],"names":["React","Link","journalContext","config","TokenService","Edit","props","submitUpdate","e","preventDefault","updatedEntry","content","bodyInput","current","value","fetch","API_ENDPOINT","context","user_name","match","params","id","method","headers","getAuthToken","body","JSON","stringify","then","res","ok","json","Promise","reject","updatePost","history","push","catch","error","alert","createRef","state","token","options","response","Error","statusText","responseJson","setState","message","err","console","log","getContent","posts","filter","post","Component","defaultProps","goBack","contextType"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport journalContext from '../journal-context';\nimport config from '../config';\nimport TokenService from '../Auth-Service/token-services';\nimport './Edit.css';\n\nexport default class Edit extends React.Component {\n\n    static defaultProps = {\n        history: {\n            goBack: () => {}\n        },\n        match: {\n            params: {}\n        }\n    }\n\n    static contextType = journalContext;\n\n    constructor(props){\n        super(props)\n        this.bodyInput = React.createRef();\n        this.state = {\n            error : null\n        }\n        \n    }\n\n    componentDidMount(){\n        const token = TokenService.getAuthToken();\n        const options = {\n            method: 'GET',\n            headers: {\n                'session_token':token\n            }\n        }\n\n        fetch(`${config.API_ENDPOINT}/api/validate`, options)\n            .then(response => {\n                if(response.ok){\n\n                    return response.json()\n                }\n                throw new Error(response.statusText)\n            })\n            .then( responseJson => {\n                this.setState({\n                    message: responseJson.message\n                })\n            })\n            .catch( err => {\n                console.log(err.message);\n                this.props.history.push('/')\n            })\n\n    }\n\n    submitUpdate = (e) => {\n        e.preventDefault();\n\n        let updatedEntry = {\n            content: this.bodyInput.current.value\n\n        }\n\n       fetch(`${config.API_ENDPOINT}/api/${this.context.user_name}/${this.props.match.params.id}`,  {\n        method: 'PATCH',\n        headers: {\n            'content-type': 'application/json',\n            'session_token': TokenService.getAuthToken()\n        },\n        body: JSON.stringify(updatedEntry),\n        })\n        .then(res => {\n            if(!res.ok){\n                return res.json().then(e => Promise.reject(e))\n            }\n            return res\n        })\n        .then(() => {\n            this.context.updatePost({id:this.props.match.params.id, content: this.bodyInput.current.value})\n            this.props.history.push('/dashboard')\n\n        })\n        .catch(error => {\n            alert({error})\n        })\n\n    }\n\n    render(){\n\n        let getContent = this.context.posts.filter(post =>  post.id == this.props.match.params.id)\n        \n        return (\n            <div className= 'Journal-container'>\n             <h2 className = \"Edit-label\">What Would you like to Change?</h2>\n            <form className = \"Journal-form\" onSubmit = {this.submitUpdate}>\n                    <textarea \n                        type=\"textarea\"\n                        name=\"body\"\n                        id=\"body\"\n                        ref={this.bodyInput} \n                        defaultValue = {getContent[0].content}\n                        className = 'Entry-content'\n                        rows = \"23\" \n                        cols=\"70\"                        \n\n                    />\n                    <button className='Edit-button' >Edit</button>\n            </form>      \n            </div>\n        )\n\n   }\n\n}"]},"metadata":{},"sourceType":"module"}